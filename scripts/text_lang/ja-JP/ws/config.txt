<h1>設定</h1>

<section>
<a name="con"></a><h3><b>コンセプト</b></h3>

<p>ここでは、設定の詳細に入る前に知っておくべき基本的な概念をいくつか紹介します。</p>

<a name="vh"></a><h3>バーチャルホスト</h3>

<p>LiteSpeed Webサーバーは、1つのサーバーインスタンスで複数のWebサイト（バーチャルホスト）をホストできます。</p> 

<p>従来、バーチャルホストは、IPベースのバーチャルホストと名前ベースのバーチャルホストの2種類に分類されていました。
   IPベースのバーチャルホストは、独自の一意のIPアドレスを持つWebサイトです。
   名前ベースのバーチャルホストは、ドメイン名で区別されるWebサイトであるため、他のサイトとIPアドレスを共有することができます。
   LiteSpeed Web Serverでは、これらの2つのカテゴリが明確に区別されていません。
   IPベースのバーチャルホストは、特殊な名前ベースのバーチャルホストと見なされます。
   どちらも簡単に構成することも、一緒に混合することもできます。</p>
<p>他のWebサーバーと異なり、LiteSpeed Web Serverには既定のWebサイトはありません。
   1つのWebサイトだけがホストされていても、すべてのWebサイトはバーチャルホストとして構成されます。</p> 

<a name="l"></a><h3>リスナー</h3>

<p>LiteSpeed Web Serverでは、リスナは特定のIPアドレスとTCPポートをリッスンするサーバーソケットです。
   Webサーバーを建物と見なした場合、リスナーはドア（それぞれが独自のIPアドレスとポートを持つ）です。
   クライアント（ブラウザ）は、リクエストを送信するためにドア（リスナー）を通過する必要があります。</p>
  
<p>各リスナーに対して、IPアドレスとポート番号を指定する必要があります。
   IPアドレスは任意の有効なローカルIPアドレスにすることができます。また、そのマシン上で使用可能なすべてのIPアドレスを参照するワイルドカードIP（*）を設定することもできます。
   ポートは0〜65535の整数です。
   HTTPのデフォルトのポートは、HTTPSの場合は80と443です。
   UNIXマシンでは他のポートも使用できますが、スーパーユーザーのrootのみが1024未満のポートを使用する権限を持っています。</p>
  
<p>IPとポートの組み合わせごとに1つのリスナーのみが許可されます。
   したがって、リスナーがワイルドカードIPアドレスを持つ1つのポートに設定されている場合、特定のIPを指定しても、別のリスナーを同じポートに設定することはできません。
   たとえば、Webサーバーマシンに複数のIPアドレスがあり、すべてのポート8080でHTTPトラフィックを許可する必要がある場合
   IPアドレスを設定するには、次の2つの方法で設定できます。
   ワイルドカードIP（*）とポート8080を使用して1つのリスナーを設定するか、IPごとに1つずつ、ポート8080をリッスンする複数のリスナーを設定します。
   これらの2つの方法を1つのポートで混在させることはできません。</p>
    
<p>LiteSpeed Web Serverには、プレーンとセキュア（SSL）の2種類のリスナーがあります。
   各セキュアリスナーには、ペアのSSL秘密鍵とSSL証明書が必要です。
   秘密鍵は、OpenSSLのようなSSLツールキットで生成することができます。
   SSL証明書は、自己署名することも、VeriSignやThawteなどのSSL証明書発行者から取得することもできます。  
   複数のリスナー間で同じ秘密鍵と証明書のペアを共有できます。</p>    

<a name="map"></a><h3>リスナーからバーチャルホストへのマッピング</h3>

<p>LiteSpeedのListener to Virtual Host Mappingは、次のような柔軟性を提供します：</p>
<ul>
<li>1つのリスナーを1つのバーチャルホストにマッピングします。</li>
<li>1つのリスナを異なるドメイン名の異なるバーチャルホストにマッピングします。</li>
<li>複数のリスナーを同じバーチャルホストにマップします。</li>
<li>ドメイン名に応じて、複数のバーチャルホストに複数のリスナーをマップします。</li>
</ul>

<p>リスナーからバーチャルホストへのマッピングでは、すべてのリスナーに、特定のバーチャルホスト（値）のドメイン名（キー）を指定するキーと値のペアを持つバーチャルホストルックアップテーブルがあります。</p>

<p>ブラウザがWebサーバーからWebページを取得しようとすると、まずDNSルックアップを使用して、そのドメイン名に関連付けられたIPアドレスが検索されます。
   次に、特定のIPとポート上のWebサーバーとのTCP接続を確立する要求を送信します。
   そのIPとポートにリスナーが割り当てられている場合は、接続が確立されます。
   ブラウザはHTTPリクエストを送信します.HTTPリクエストには、アクセスされているWebサイトのドメイン名がヘッダーに含まれています。
   Webサーバーは、リクエスト内のドメイン名について、そのリスナーに関連付けられているルックアップテーブルをチェックします。
   一致するものが見つかると、要求はバーチャルホストにルーティングされて処理されます。</p>

<p>特定のリスナーを介してバーチャルホストにアクセスできるようにするには、次の点を確認する必要があります：</p>
<ol>
	<li>DNSは、Webサイトのドメイン名をそのリスナーが使用するIPにマップするように正しく設定されています。
DNSの設定方法はこのドキュメントの範囲を超えています。</li>
    <li>そのドメイン名のバーチャルホストへのマッピングが、リスナーのルックアップテーブルに存在します。</li>
</ol>

<p>ワイルドカードドメイン名「*」を持つ1つのリスナーに対してキャッチオールバーチャルホストを指定できます。
   サーバーが一致するバーチャルホストを見つけることができない場合、要求はキャッチオールバーチャルホストにルーティングされます。
   そのようなキャッチオールバーチャルホストが設定されていない場合、Webサーバはエラーコード404を返します。</p>


